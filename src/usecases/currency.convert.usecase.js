const { httpRequest } = require("../adapters/http.utils");

async function getCurrency(baseCurrency){
    // this is from https://github.com/fawazahmed0/exchange-api, not sure where he gets his info.
    if(baseCurrency){
        baseCurrency = baseCurrency.trim().toLowerCase();
        const url = `https://latest.currency-api.pages.dev/v1/currencies/${baseCurrency}.json`
        const opts = {
            host: 'latest.currency-api.pages.dev',
            method: 'GET',
            path: encodeURI(`/v1/currencies/${baseCurrency}.json`)
        }
        // console.log(opts.path);
        const result = await httpRequest(opts, undefined, true);
        if(result.statusCode < 400 && result.body && result.body.date){
            return result.body;
        }else {
            if("jpy" === baseCurrency){
                return jpyFallback;
            }
            else if("usd" === baseCurrency){
                return usdFallback;
            }
        }
    }
}

module.exports.GetCurrencyRates = getCurrency;

const usdFallback = {
	"date": "2025-05-27",
	"usd": {
		"1inch": 4.44664755,
		"aave": 0.003785716,
		"ada": 1.29486133,
		"aed": 3.6725,
		"afn": 69.93732945,
		"agix": 2.6303774,
		"akt": 0.67417403,
		"algo": 4.64648112,
		"all": 86.16778344,
		"amd": 384.05720242,
		"amp": 220.30348879,
		"ang": 1.79955668,
		"aoa": 917.6524168,
		"ape": 1.54577466,
		"apt": 0.19109398,
		"ar": 0.14032633,
		"arb": 2.60900241,
		"ars": 1143.48730248,
		"atom": 0.2121715,
		"ats": 12.07694382,
		"aud": 1.54205547,
		"avax": 0.044098337,
		"awg": 1.79,
		"axs": 0.36239642,
		"azm": 8500.01591199,
		"azn": 1.70000318,
		"bake": 7.87058195,
		"bam": 1.71656498,
		"bat": 7.22337788,
		"bbd": 2,
		"bch": 0.002437569,
		"bdt": 121.86954649,
		"bef": 35.404948,
		"bgn": 1.71656498,
		"bhd": 0.376,
		"bif": 2974.38665671,
		"bmd": 1,
		"bnb": 0.0014969095,
		"bnd": 1.28359473,
		"bob": 6.89799129,
		"brl": 5.66856813,
		"bsd": 1,
		"bsv": 0.028017475,
		"bsw": 34.45092244,
		"btc": 0.0000092497,
		"btcb": 4.58330271,
		"btg": 1.39164125,
		"btn": 85.07599422,
		"btt": 1404558.3213519,
		"busd": 1.00131136,
		"bwp": 13.44347308,
		"byn": 3.27289584,
		"byr": 32728.9583855,
		"bzd": 2.01203439,
		"cad": 1.37332867,
		"cake": 0.41486437,
		"cdf": 2899.98958594,
		"celo": 2.74816788,
		"cfx": 11.72611876,
		"chf": 0.81986975,
		"chz": 23.43694105,
		"clp": 940.38819319,
		"cnh": 7.18322484,
		"cny": 7.18991288,
		"comp": 0.024029637,
		"cop": 4151.04141894,
		"crc": 508.23653208,
		"cro": 10.41925565,
		"crv": 1.34797961,
		"cspr": 65.21999652,
		"cuc": 1,
		"cup": 23.96612735,
		"cve": 96.78020065,
		"cvx": 0.31634895,
		"cyp": 0.51367494,
		"czk": 21.84009092,
		"dai": 1.00099901,
		"dash": 0.043037784,
		"dcr": 0.06645514,
		"dem": 1.71656498,
		"dfi": 151.08176388,
		"djf": 177.9573709,
		"dkk": 6.54560967,
		"doge": 4.5036729,
		"dop": 58.85191268,
		"dot": 0.2266156,
		"dydx": 1.72320996,
		"dzd": 131.96904947,
		"eek": 13.7325198,
		"egld": 0.056626422,
		"egp": 49.81179507,
		"enj": 11.65837528,
		"eos": 1.2938444,
		"ern": 15,
		"esp": 146.03129107,
		"etb": 135.54203069,
		"etc": 0.055527064,
		"eth": 0.0003954376,
		"eur": 0.87766574,
		"fei": 1.00113187,
		"fil": 0.36190999,
		"fim": 5.21836349,
		"fjd": 2.25207356,
		"fkp": 0.73680485,
		"flow": 2.59054212,
		"flr": 54.25810453,
		"frax": 0.29133254,
		"frf": 5.75710983,
		"ftt": 0.88098461,
		"gala": 53.43035102,
		"gbp": 0.73680485,
		"gel": 2.73495532,
		"ggp": 0.73680485,
		"ghc": 104292.14889569,
		"ghs": 10.42921489,
		"gip": 0.73680485,
		"gmd": 72.4113122,
		"gmx": 0.065653882,
		"gnf": 8656.58419757,
		"gno": 0.0076525013,
		"grd": 299.06459937,
		"grt": 9.29530931,
		"gt": 0.047448818,
		"gtq": 7.66897097,
		"gusd": 1.00086801,
		"gyd": 209.24879093,
		"hbar": 5.45250712,
		"hkd": 7.83778865,
		"hnl": 26.02256022,
		"hnt": 0.2465092,
		"hot": 916.86132501,
		"hrk": 6.61277248,
		"ht": 3.19600103,
		"htg": 130.60382736,
		"huf": 354.27463935,
		"icp": 0.19501839,
		"idr": 16243.58445757,
		"iep": 0.69121794,
		"ils": 3.55814515,
		"imp": 0.73680485,
		"imx": 1.60773706,
		"inj": 0.073880649,
		"inr": 85.07599422,
		"iqd": 1308.90475892,
		"irr": 42123.94938809,
		"isk": 126.7483724,
		"itl": 1699.39783365,
		"jep": 0.73680485,
		"jmd": 158.77249944,
		"jod": 0.709,
		"jpy": 142.32570075,
		"kas": 9.7085534,
		"kava": 2.41734977,
		"kcs": 0.088956806,
		"kda": 1.87927255,
		"kes": 129.21179778,
		"kgs": 87.47732457,
		"khr": 3991.1313952,
		"klay": 8.83642177,
		"kmf": 431.78323714,
		"knc": 2.81439751,
		"kpw": 899.98604508,
		"krw": 1368.90310298,
		"ksm": 0.056126703,
		"kwd": 0.30635646,
		"kyd": 0.83143579,
		"kzt": 510.75022904,
		"lak": 21572.22956872,
		"lbp": 89617.5677779,
		"ldo": 1.15686582,
		"leo": 0.11283551,
		"link": 0.065349985,
		"lkr": 299.24721901,
		"lrc": 10.20931315,
		"lrd": 199.88289526,
		"lsl": 17.86313619,
		"ltc": 0.010672868,
		"ltl": 3.03040425,
		"luf": 35.404948,
		"luna": 5.78218878,
		"lunc": 16288.4482568,
		"lvl": 0.61682348,
		"lyd": 5.44297706,
		"mad": 9.19303323,
		"mana": 3.32230326,
		"mbx": 4.90502061,
		"mdl": 17.25333684,
		"mga": 4534.82825612,
		"mgf": 22674.14128061,
		"mina": 4.1247224,
		"mkd": 54.04279725,
		"mkr": 0.00062079772,
		"mmk": 2099.46320861,
		"mnt": 3577.43936358,
		"mop": 8.07292231,
		"mro": 395.85823663,
		"mru": 39.58582366,
		"mtl": 0.3767819,
		"mur": 45.40531673,
		"mvr": 15.45962777,
		"mwk": 1732.33705819,
		"mxn": 19.24174019,
		"mxv": 2.27017344,
		"myr": 4.20437315,
		"mzm": 63884.92568728,
		"mzn": 63.88492569,
		"nad": 17.86313619,
		"near": 0.36693822,
		"neo": 0.15655678,
		"nexo": 0.80001183,
		"nft": 2307374.48793894,
		"ngn": 1581.63663157,
		"nio": 36.77671137,
		"nlg": 1.93412076,
		"nok": 10.09340832,
		"npr": 136.18539774,
		"nzd": 1.66805072,
		"okb": 0.019331962,
		"omr": 0.38497811,
		"one": 73.45138382,
		"op": 1.34112651,
		"ordi": 0.099845304,
		"pab": 1,
		"paxg": 0.00029910156,
		"pen": 3.65660218,
		"pepe": 73976.30954659,
		"pgk": 4.11912653,
		"php": 55.3741221,
		"pkr": 281.83636352,
		"pln": 3.72360904,
		"pol": 4.39030492,
		"pte": 175.95618198,
		"pyg": 7973.21552591,
		"qar": 3.64,
		"qnt": 0.0097015009,
		"qtum": 0.46241253,
		"rol": 44468.05736999,
		"ron": 4.44680574,
		"rpl": 0.21505997,
		"rsd": 102.89909682,
		"rub": 79.7797355,
		"rune": 0.52865187,
		"rvn": 84.94052213,
		"rwf": 1429.59336067,
		"sand": 3.34087781,
		"sar": 3.75,
		"sbd": 8.50960553,
		"scr": 14.22172698,
		"sdd": 60049.65696165,
		"sdg": 600.49656962,
		"sek": 9.51154658,
		"sgd": 1.28359473,
		"shib": 70362.01660678,
		"shp": 0.73680485,
		"sit": 210.32381685,
		"skk": 26.44055795,
		"sle": 22.87496025,
		"sll": 22874.9602467,
		"snx": 1.31808217,
		"sol": 0.0058176359,
		"sos": 569.72440723,
		"spl": 0.16666667,
		"srd": 36.65174712,
		"srg": 36651.74712347,
		"std": 21666.4023388,
		"stn": 21.66640234,
		"stx": 1.15323129,
		"sui": 0.29106344,
		"svc": 8.75,
		"syp": 13001.85834193,
		"szl": 17.86313619,
		"thb": 32.58919011,
		"theta": 1.2045061,
		"tjs": 10.12593638,
		"tmm": 17543.7220992,
		"tmt": 3.50874442,
		"tnd": 2.97672951,
		"ton": 0.34079548,
		"top": 2.40822323,
		"trl": 39001322.91650812,
		"trx": 3.66418323,
		"try": 39.00132292,
		"ttd": 6.79628845,
		"tusd": 1.00237677,
		"tvd": 1.54205547,
		"twd": 29.86121215,
		"twt": 1.21000557,
		"tzs": 2698.37161192,
		"uah": 41.63004256,
		"ugx": 3647.61774127,
		"uni": 0.15782693,
		"usd": 1,
		"usdc": 1.00105672,
		"usdd": 1.00045744,
		"usdp": 1.00109157,
		"usdt": 1.0006568,
		"uyu": 41.56180841,
		"uzs": 12914.6435363,
		"val": 1699.39783365,
		"veb": 9511812942.881453,
		"ved": 95.11950797,
		"vef": 9511950.79667997,
		"ves": 95.11950797,
		"vet": 36.98877293,
		"vnd": 25923.71338916,
		"vuv": 121.09024245,
		"waves": 0.83910813,
		"wemix": 2.66058343,
		"woo": 11.40357134,
		"wst": 2.75621774,
		"xaf": 575.71098285,
		"xag": 0.030008029,
		"xau": 0.0002999352,
		"xaut": 0.00030029419,
		"xbt": 0.0000092497,
		"xcd": 2.70734111,
		"xcg": 1.79955668,
		"xch": 0.080735743,
		"xdc": 14.89346336,
		"xdr": 0.73669653,
		"xec": 46044.08085424,
		"xem": 100.83443483,
		"xlm": 3.53323755,
		"xmr": 0.002513733,
		"xof": 575.71098285,
		"xpd": 0.0010158289,
		"xpf": 104.73338132,
		"xpt": 0.0009229333,
		"xrp": 0.43763063,
		"xtz": 1.66490834,
		"yer": 243.87437498,
		"zar": 17.86313619,
		"zec": 0.018669014,
		"zil": 80.78542918,
		"zmk": 27555.61381482,
		"zmw": 27.55561381,
		"zwd": 361.9,
		"zwg": 26.89620743,
		"zwl": 67206.20439112
	}
}
const jpyFallback = {
	"date": "2025-05-27",
	"jpy": {
		"1inch": 0.031242759,
		"aave": 0.000026598963,
		"ada": 0.0090978743,
		"aed": 0.025803491,
		"afn": 0.49138932,
		"agix": 0.018481394,
		"akt": 0.0047368397,
		"algo": 0.032646817,
		"all": 0.60542673,
		"amd": 2.69843887,
		"amp": 1.54788269,
		"ang": 0.012643933,
		"aoa": 6.44755242,
		"ape": 0.010860826,
		"apt": 0.0013426527,
		"ar": 0.00098595217,
		"arb": 0.018331211,
		"ars": 8.03429947,
		"atom": 0.0014907462,
		"ats": 0.084854273,
		"aud": 0.010834694,
		"avax": 0.000309841,
		"awg": 0.012576787,
		"axs": 0.0025462473,
		"azm": 59.72228394,
		"azn": 0.011944457,
		"bake": 0.055299794,
		"bam": 0.012060822,
		"bat": 0.050752449,
		"bbd": 0.014052276,
		"bch": 0.000017126696,
		"bdt": 0.85627224,
		"bef": 0.24876005,
		"bgn": 0.012060822,
		"bhd": 0.0026418278,
		"bif": 20.89845081,
		"bmd": 0.0070261379,
		"bnb": 0.000010517493,
		"bnd": 0.0090187136,
		"bob": 0.048466238,
		"brl": 0.039828141,
		"bsd": 0.0070261379,
		"bsv": 0.00019685464,
		"bsw": 0.24205693,
		"btc": 6.4989668e-8,
		"btcb": 0.032202917,
		"btg": 0.0097778633,
		"btn": 0.59775567,
		"btt": 9868.62045227,
		"busd": 0.0070353517,
		"bwp": 0.094455696,
		"byn": 0.022995817,
		"byr": 229.95817489,
		"bzd": 0.014136831,
		"cad": 0.0096491966,
		"cake": 0.0029148943,
		"cdf": 20.37572673,
		"celo": 0.019309006,
		"cfx": 0.082389327,
		"chf": 0.0057605179,
		"chz": 0.16467118,
		"clp": 6.60729712,
		"cnh": 0.050470328,
		"cny": 0.050517319,
		"comp": 0.00016883554,
		"cop": 29.16578943,
		"crc": 3.57093996,
		"cro": 0.073207127,
		"crv": 0.0094710906,
		"cspr": 0.45824469,
		"cuc": 0.0070261379,
		"cup": 0.16838932,
		"cve": 0.67999104,
		"cvx": 0.0022227114,
		"cyp": 0.0036091509,
		"czk": 0.15345149,
		"dai": 0.0070331571,
		"dash": 0.00030238941,
		"dcr": 0.00046692297,
		"dem": 0.012060822,
		"dfi": 1.06152131,
		"djf": 1.25035303,
		"dkk": 0.045990356,
		"doge": 0.031643427,
		"dop": 0.41350165,
		"dot": 0.0015922325,
		"dydx": 0.012107511,
		"dzd": 0.92723274,
		"eek": 0.096486578,
		"egld": 0.00039786505,
		"egp": 0.34998454,
		"enj": 0.081913352,
		"eos": 0.0090907292,
		"ern": 0.10539207,
		"esp": 1.02603599,
		"etb": 0.952337,
		"etc": 0.00039014081,
		"eth": 0.0000027783991,
		"eur": 0.0061666005,
		"fei": 0.0070340906,
		"fil": 0.0025428295,
		"fim": 0.036664942,
		"fjd": 0.015823379,
		"fkp": 0.0051768925,
		"flow": 0.018201506,
		"flr": 0.38122492,
		"frax": 0.0020469426,
		"frf": 0.040450248,
		"ftt": 0.0061899193,
		"gala": 0.37540901,
		"gbp": 0.0051768925,
		"gel": 0.019216173,
		"ggp": 0.0051768925,
		"ghc": 732.77101987,
		"ghs": 0.073277102,
		"gip": 0.0051768925,
		"gmd": 0.50877186,
		"gmx": 0.00046129323,
		"gnf": 60.8223543,
		"gno": 0.00005376753,
		"grd": 2.10126912,
		"grt": 0.065310125,
		"gt": 0.00033338194,
		"gtq": 0.053883248,
		"gusd": 0.0070322366,
		"gyd": 1.47021086,
		"hbar": 0.038310067,
		"hkd": 0.055069384,
		"hnl": 0.1828381,
		"hnt": 0.0017320076,
		"hot": 6.4419941,
		"hrk": 0.046462251,
		"ht": 0.022455544,
		"htg": 0.9176405,
		"huf": 2.48918247,
		"icp": 0.0013702261,
		"idr": 114.12966436,
		"iep": 0.0048565925,
		"ils": 0.025000018,
		"imp": 0.0051768925,
		"imx": 0.011296182,
		"inj": 0.00051909563,
		"inr": 0.59775567,
		"iqd": 9.19654533,
		"irr": 295.96867723,
		"isk": 0.89055154,
		"itl": 11.94020352,
		"jep": 0.0051768925,
		"jmd": 1.11555748,
		"jod": 0.0049815318,
		"jpy": 1,
		"kas": 0.068213635,
		"kava": 0.016984633,
		"kcs": 0.00062502279,
		"kda": 0.013204028,
		"kes": 0.90785991,
		"kgs": 0.61462775,
		"khr": 28.04223955,
		"klay": 0.062085918,
		"kmf": 3.03376857,
		"knc": 0.019774345,
		"kpw": 6.32342606,
		"krw": 9.61810197,
		"ksm": 0.00039435396,
		"kwd": 0.0021525027,
		"kyd": 0.0058417825,
		"kzt": 3.58860154,
		"lak": 151.56945973,
		"lbp": 629.66538933,
		"ldo": 0.0081282988,
		"leo": 0.00079279785,
		"link": 0.00045915801,
		"lkr": 2.10255223,
		"lrc": 0.071732042,
		"lrd": 1.40440479,
		"lsl": 0.12550886,
		"ltc": 0.000074989041,
		"ltl": 0.021292038,
		"luf": 0.24876005,
		"luna": 0.040626456,
		"lunc": 114.4448836,
		"lvl": 0.0043338868,
		"lyd": 0.038243107,
		"mad": 0.064591519,
		"mana": 0.023342961,
		"mbx": 0.034463351,
		"mdl": 0.12122432,
		"mga": 31.86232867,
		"mgf": 159.31164337,
		"mina": 0.028980868,
		"mkd": 0.37971215,
		"mkr": 0.0000043618104,
		"mmk": 14.75111802,
		"mnt": 25.13558229,
		"mop": 0.056721465,
		"mro": 2.78135456,
		"mru": 0.27813546,
		"mtl": 0.0026473216,
		"mur": 0.31902402,
		"mvr": 0.10862148,
		"mwk": 12.17163906,
		"mxn": 0.13519512,
		"mxv": 0.015950552,
		"myr": 0.029540506,
		"mzm": 448.86429751,
		"mzn": 0.4488643,
		"nad": 0.12550886,
		"near": 0.0025781585,
		"neo": 0.0010999895,
		"nexo": 0.0056209934,
		"nft": 16211.93133569,
		"ngn": 11.11279708,
		"nio": 0.25839825,
		"nlg": 0.013589399,
		"nok": 0.070917679,
		"npr": 0.95685738,
		"nzd": 0.011719954,
		"okb": 0.00013582903,
		"omr": 0.0027049093,
		"one": 0.51607955,
		"op": 0.0094229398,
		"ordi": 0.00070152688,
		"pab": 0.0070261379,
		"paxg": 0.0000021015288,
		"pen": 0.025691791,
		"pepe": 519.76775209,
		"pgk": 0.028941551,
		"php": 0.38906622,
		"pkr": 1.98022115,
		"pln": 0.026162591,
		"pol": 0.030846888,
		"pte": 1.2362924,
		"pyg": 56.02091178,
		"qar": 0.025575142,
		"qnt": 0.000068164083,
		"qtum": 0.0032489742,
		"rol": 312.43870316,
		"ron": 0.03124387,
		"rpl": 0.001511041,
		"rsd": 0.72298324,
		"rub": 0.56054342,
		"rune": 0.0037143809,
		"rvn": 0.59680382,
		"rwf": 10.04452009,
		"sand": 0.023473468,
		"sar": 0.026348017,
		"sbd": 0.059789662,
		"scr": 0.099923815,
		"sdd": 421.91717057,
		"sdg": 4.21917171,
		"sek": 0.066829438,
		"sgd": 0.0090187136,
		"shib": 494.37323149,
		"shp": 0.0051768925,
		"sit": 1.47776414,
		"skk": 0.18577501,
		"sle": 0.16072263,
		"sll": 160.72262512,
		"snx": 0.0092610271,
		"sol": 0.000040875512,
		"sos": 4.00296225,
		"spl": 0.001171023,
		"srd": 0.25752023,
		"srg": 257.52022951,
		"std": 152.2311306,
		"stn": 0.15223113,
		"stx": 0.0081027621,
		"sui": 0.0020450518,
		"svc": 0.061478707,
		"syp": 91.35284965,
		"szl": 0.12550886,
		"thb": 0.22897614,
		"theta": 0.0084630259,
		"tjs": 0.071146225,
		"tmm": 123.26461072,
		"tmt": 0.024652922,
		"tnd": 0.020914912,
		"ton": 0.002394476,
		"top": 0.016920508,
		"trl": 274028.67303445,
		"trx": 0.025745057,
		"try": 0.27402867,
		"ttd": 0.04775166,
		"tusd": 0.0070428374,
		"tvd": 0.010834694,
		"twd": 0.20980899,
		"twt": 0.008501666,
		"tzs": 18.95913105,
		"uah": 0.29249842,
		"ugx": 25.62866525,
		"uni": 0.0011089137,
		"usd": 0.0070261379,
		"usdc": 0.0070335626,
		"usdd": 0.0070293519,
		"usdp": 0.0070338074,
		"usdt": 0.0070307527,
		"uyu": 0.292019,
		"uzs": 90.7400664,
		"val": 11.94020352,
		"veb": 66831309.40121049,
		"ved": 0.66832278,
		"vef": 66832.27798101,
		"ves": 0.66832278,
		"vet": 0.25988822,
		"vnd": 182.14358511,
		"vuv": 0.85079674,
		"waves": 0.0058956894,
		"wemix": 0.018693626,
		"woo": 0.080123065,
		"wst": 0.019365566,
		"xaf": 4.04502476,
		"xag": 0.00021084055,
		"xau": 0.0000021073861,
		"xaut": 0.0000021099084,
		"xbt": 6.4989668e-8,
		"xcd": 0.019022152,
		"xcg": 0.012643933,
		"xch": 0.00056726046,
		"xdc": 0.10464353,
		"xdr": 0.0051761314,
		"xec": 323.51206149,
		"xem": 0.70847664,
		"xlm": 0.024825014,
		"xmr": 0.000017661835,
		"xof": 4.04502476,
		"xpd": 0.0000071373539,
		"xpf": 0.73587118,
		"xpt": 0.0000064846566,
		"xrp": 0.0030748531,
		"xtz": 0.011697876,
		"yer": 1.71349499,
		"zar": 0.12550886,
		"zec": 0.00013117107,
		"zil": 0.56760957,
		"zmk": 193.60954254,
		"zmw": 0.19360954,
		"zwd": 2.54275931,
		"zwg": 0.18897646,
		"zwl": 472.20005969
	}
}